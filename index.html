<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TRIDUC HTTP MONITOR</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hls.js/1.4.0/hls.min.js"></script>
    <style>
        body { 
            background: #000; margin: 0; color: #fff; 
            font-family: 'Segoe UI', sans-serif; 
            display: flex; flex-direction: column; height: 100vh; overflow: hidden;
        }
        
        /* Header c·∫£nh b√°o HTTP */
        header { 
            padding: 5px 15px; background: #222; 
            display: flex; gap: 10px; border-bottom: 2px solid #ff0000; /* M√†u ƒë·ªè c·∫£nh b√°o kh√¥ng b·∫£o m·∫≠t */
            align-items: center; justify-content: space-between; height: 40px;
        }
        
        .brand { font-weight: bold; color: #fff; text-transform: uppercase; font-size: 14px; }
        .server-info { color: #ff5555; font-size: 11px; font-family: monospace; font-weight: bold;}
        
        button { 
            cursor: pointer; padding: 4px 10px; background: #333; color: #fff; 
            border: 1px solid #555; border-radius: 4px; font-size: 11px;
        }
        button:hover { background: #ff0000; color: #fff; border-color: #ff0000; }
        
        #video-grid { 
            flex-grow: 1; display: grid; 
            grid-template-columns: repeat(4, 1fr); 
            grid-template-rows: repeat(5, 1fr); 
            gap: 1px; padding: 1px;
        }
        
        .cam-box { 
            position: relative; background: #111; border: 1px solid #222; 
            overflow: hidden; display: flex; align-items: center; justify-content: center;
        }
        
        video { width: 100%; height: 100%; object-fit: contain; }
        
        .label { 
            position: absolute; top: 0; left: 0; 
            background: rgba(0,0,0,0.7); padding: 2px 6px; 
            font-size: 11px; color: #fff; z-index: 2; font-weight: bold;
        }
        
        .status-msg { 
            position: absolute; color: #666; font-size: 11px; 
            text-align: center; font-family: monospace;
        }
    </style>
</head>
<body>
    <header>
        <div>
            <span class="brand">TriDuc Media</span>
            <span class="server-info"> | HTTP MODE (Not Secure)</span>
        </div>
        <button onclick="location.reload()">Reload</button>
    </header>
    
    <div id="video-grid"></div>

    <script>
        // üëá C·∫§U H√åNH ƒê√öNG Y√äU C·∫¶U C·ª¶A B·∫†N (HTTP + PORT 5003)
        const SERVER_HOST = 'http://triducmedia.ddns.net:5003';
        
        // Danh s√°ch k√™nh (Bao g·ªìm studio2)
        const STREAMS = [
            'source', 'source1', 'source2', 'source3', 'source4', 'source5',
            'studio1', 'studio2', // <-- K√™nh b·∫°n v·ª´a y√™u c·∫ßu n·∫±m ·ªü ƒë√¢y
            'laptop1', 'laptop2', 'laptop3', 'laptop4', 'laptop5', 
            'laptop6', 'laptop7', 'laptop8', 'laptop9', 'laptop10'
        ];

        document.addEventListener("DOMContentLoaded", () => {
            const grid = document.getElementById('video-grid');
            STREAMS.forEach(name => {
                const div = document.createElement('div');
                div.className = 'cam-box';
                div.innerHTML = `
                    <div class="label">${name.toUpperCase()}</div>
                    <div class="status-msg" id="msg-${name}">Connecting...</div>
                    <video id="v-${name}" muted playsinline autoplay></video>
                `;
                grid.appendChild(div);
                load(name);
            });
        });

        function load(name) {
            const video = document.getElementById(`v-${name}`);
            const msgDiv = document.getElementById(`msg-${name}`);
            
            // ƒê∆∞·ªùng d·∫´n gh√©p th√†nh: http://triducmedia.ddns.net:5003/hls/studio2/index.m3u8
            const url = `${SERVER_HOST}/hls/${name}/index.m3u8`;

            video.onplaying = () => { msgDiv.style.display = 'none'; };
            video.onwaiting = () => { msgDiv.style.display = 'block'; msgDiv.innerText = "Buffering..."; };
            
            video.onerror = () => {
                msgDiv.style.display = 'block';
                msgDiv.innerText = "OFFLINE";
                msgDiv.style.color = "red";
            };

            if (video.canPlayType('application/vnd.apple.mpegurl')) {
                video.src = url;
            } else if (Hls.isSupported()) {
                const hls = new Hls({
                    capLevelToPlayerSize: true,
                    maxBufferLength: 10,
                });
                hls.loadSource(url);
                hls.attachMedia(video);
                hls.on(Hls.Events.ERROR, (event, data) => {
                    if (data.fatal) {
                         if (data.type === Hls.ErrorTypes.NETWORK_ERROR) hls.startLoad();
                    }
                });
            }
        }
    </script>
</body>
</html>
